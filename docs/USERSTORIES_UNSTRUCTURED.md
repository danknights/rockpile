This is an ustructured narrative of user stories for the LiDAR app. 

This code is working and it successfully makes a map and lets you zoom in and see boulders and click on them and see 3-D maps of them, same for cliffs. I would like to add a map filter button that lets you  Filter by type (Cliff or Boulder), whether anyone has put eyes on it, whether the user themselves have visited it (seen it), height, width, distance from road, bushwhack distance, and possibly others later. You should be able to use a combination of these. Other key properties to filter by our favorites, hardness.
Any feature that has been marked "not a rock" we'll have a gray place mark on the map and will not show a polygon. You can also filter by whether a rock has been marked with any sends, projects, or possible lines.

I also want to add a little blue dot showing the users current location on the map, with a little tiny Chevron style arrow on it showing which direction the user is pointing.

The user should be able to toggle satellite imagery on and off. If it is titled on the map will show 3-D structure. If it is to off,The map should have elevation contour lines. Either way, the map will show roads and paths. The map will also show polygons and labels indicating all known public plant, this is state forest, State Park, national Forest, national Park, wilderness areas, and other things. These should be shown with a little dash boundary or something and then likea semi transparent overlay.

The map also currently shows which areas have been scanned. This is a different colored overlay. Maybe we can because I'm a little worried about the different colored overlays causing weird colors, just put a semi transparent gray polygon over all non-public land. Then we don't need to have anything on the public land, we can justput a little label next to the border whenever the user is zoomed in or if they're zoomed out we can have an automatic label next to the boundary seeing what the public land is, and we can have the word private on the private land.

The user should be able to tap on a boulder or cliff and get a pop-up window that occupies maybe 80% of the screen. It should have the 3D viewer at the top, occupying the full width of the popup and maybe about the top 1/3 of the visible popup vertically. It should have one of those little squares that makes it clear. You can tap the square in the corner to make it full screen mode, but then when you're in full screen mode, you can also tap out of that. Then in the same popup, below the 3d viewer, there is a page with text and icons and images and comments section. At the top of this page, just below the 3-D viewer, on the top right will be a little toggle button that says publish. This will be great out if they had not made any edits. But once they have done anything, like added a favorite, marked it as seen, added a comment or video or difficulty rating, the publish button will be enabled, but by default it will not be publish

This page gives the rock's features (height, length, width, elevation, distance to road, bushwhack distance, location. There should also be some buttons on this little pop-up that lets the user mark the boulder as a favorite (heart). and maybe make a little eyeball if the Boulder has been seen, and a button to add a climb or project. If they click to add a project, that part of the page will expand down and will show options to select the V rating for boulder problems (slider bar with discrete steps) v0-v18, or YDS/European rating. We will make these a grid of radio buttons for the different ratings, so that all they have to do is make one tap. This will have everything from. VB, V0...V18 and 5.0 to 5.15d. Obviously, they can only select one. And there will be a plus/minus. And they can mark stars, and they can mark if it's a send, a project, or a possible line. And they will be offered to choose an existing photo which will show all of the photos of this rock in a single scrollable row, small icons, or to add a new photo. If they decide to tag a photo, the photo will open, and it will be in the annotation window, as described below for adding regular photos. When they click the checkbox, the tagged and annotated version of the photo will be associated with the climb and added to the photos for the boulder. 

There should also be a button or text to add link which allows user to add a link to a mountain project climbing area URL, maybe another website like Beta.io climbing area, a video URL symbol or link symbol. to add links to videos, but these will be restricted to known reputable video sites like YouTube or known climbing sites.

Next to location GPS is a copy icon and a  button that says open "go" which closes the popup and shows the map and draws a dashed line between the user and the feature. Tapping the feature again on the map will disable "go" mode. 

In the pop-up, below the features, there should be a little camera icon which lets the user add photos or take photos. As soon as they take or add a photo, there should be a preview of the photo with a big checkmark that they can click to post it, but there will be a box underneath they can tap to add notes to the photo. They can also draw directly on the photo with their finger, in pink. As soon as they draw something, little undo and redo buttons will show up at the top. Once they are done annotating, they can click check. 

If the user is online, and they click the "publish" toggle, then the toggle button will be replaced by a spinning, waiting icon while the results are uploaded, and then will turn to selected any photos, they choose to post or any links, they choose to add will be uploaded to the central database and added to the public properties for that cliff or Boulder. If the user is off-line and they select the "publish" toggle, these will be added to a queue of things that need to be uploaded when they get back online, and it will add text tiny text underneath the published toggle that says waiting for signal.

Basically, any notes that they add or photos or favorites or whatever they mark/edit/add should be private, unless they choose to share it by clicking publish. If they unclick "publish", and they are connected to the Internet, then the toggle button will be replaced by another spinning icon, while their changes are marked private on the main database, and then will turn back to unselected.

If the user on clicks the publish button and they are not connected to the Internet, then again it will be added to a queue of things that need to be marked private in the database, and it will add tiny text saying waiting for signal underneath that toggle.

 Anytime they click unpublished, it will immediately or eventually mark all of their edits and content as private for that feature. Anytime they click publish, it will update the public data to represent whatever they currently have. So if they change their ratings like the difficulty or whether they have seen something or they delete a photo or add a photo, it will synchronize their current states to the database.

There should be a comments section, model after comments like in YouTube, for example. If a user has a profile pic, there will be a little icon next to their comments. Easy to tap and add a comment. They should also be able to reply to other comments, and they should be able to edit their own comments and even delete their own comments (which would delete any replies to that comment. They should also be able to flag comments with a little flag button that gives a pop-up or drop-down and marked some thing as inappropriate. They should also be able to like or upload comments, similar to YouTube.

The pop-up should show all of the properties that we have discussed, everything from favorites, seen or not,  the estimated difficulty, photos, and comment section. This pop-up should be scrollable up and down, so that I can have virtually unlimited content, and it should take up most of the screen, but leave enough room so that they can tap outside it. It should also have a tiny x on the upper right corner to make it obvious that you can close it that way. If the user swipes right on the pop-up, it should go to the next Boulder or cliff nearby, cycling through any cliffs and boulders that are included in the main view of the map behind the pop-up. This way, the user can quickly scroll through boulders and cliffs in an area looking for cool ones.

There will be also on the main pop-up a little text, they can click on that says "not a rock" and when they tap this, it will drop down a list that says tree, building, other.

in the 3-D viewer, we will get rid of the text bar that shows all of the features, because those will show be shown below in the info page. We will a the slider that fades in nearby context lidar points, a text legend below, and a little toggle to turn on and off the 3d mesh visualization. There will also be a little text or button they can click that says "needs refinement" . If they tap this, they can choose missing some points, has extra points, or both. This will then upload a JSON file to a "needs refinement" folder on the file server.

Before the edits are uploaded to the main server, a copy of the original 3-D cloud will be made, and a simple Json file will be posted to a different folder on the server indicating that there are edits to the 3-D cloud pending review. The new edits will then be posted immediately and will become publicly available. A moderator will be able to login into their account or run a script manually that quickly shows the proposed edits in succession so that they can select and revert any if they disapprove. Once they approve, the JSON file indicating pending review will be deleted. A copy of the original 3-D cloud will always be maintained behind the scenes, maybe in a folder marked original model, versions or something, but only the most recent user-edited file will be maintained and displayed publicly.

When features are very close to each other, such as a pile of boulders, there should just be one 3-D viewer that shows all of them together, so that we don't have to download separate 3-D viewers, and because it's a better user experience. Although when we pop it open, it should be centered on the feature that the user clicked on.

The app should also have a little hamburger menu or something that lets you select various options like settings, and downloading regions for off-line use. The map should have a little download button that you can push the downloads everything in the current view for off-line use. By default, it only downloads rough satellite imagery for off-line use. It also downloads the 3-D viewer HTML files for off-line use. So the map viewer needs to know if it is using downloaded maps that it should look locally for the GLB shape files for the features, for the 3-D HTML, and of course, for all of the map layers.

The app should have typical user settings, like profile, security, appearance, offline and data usage (wifi/cellular) preferences, a toggle button that will unpublished all of their edits and public material (but with a pop-up warning that ask them if they are sure), and their profile pic and link to their YouTube channel, social media feeds, mountain Project, profile, etc.

The app should also have a view that lets you see users, and all of the comments and cliffs and ratings and photos they have added, their links to external feeds and profiles, 

# Long-term wishlist
As a very long-term feature, it would be cool if There could also be a little edit button in the 3-D window that makes it full screen, and has like a radio button for add points or subtract points. They can still turn on and off the context points as they are doing this. this view allows them to rotate the 3-D view, zoom in, and circle points with their finger. An ad mode, these points will be added to the 3-D view as part of the rock. And subtract mode, they will be removed, but retained in the context points. As soon as they make an edit, little undo and redo buttons will show up at the top. There will be a checkmark button they can click that's big and obvious which will save their edits. When they say, there will be a little pop-up window with a check box that is marked that says "share 3D model edits with XYZ (the app name). This does not affect whether or not the rest of your content for this feature is published." and a button that says OK. They have to uncheck the box and click OK if they do not want to share. Then regardless of what they selected, edits will immediately be reflected in the 3-D view, with the improved view being shown. These edits will then be added to the queue of things that are being uploaded to the main server. But this is a tall order because it is essentially making a 3-D model editing app, which is probably outside the scope.